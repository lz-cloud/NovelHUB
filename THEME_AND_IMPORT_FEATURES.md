# 新功能说明：自定义主题与 Z-Library 导入

## 功能概述

本次更新增加了以下主要功能：

### 1. 自定义主题系统

系统现在支持多种主题，用户可以根据喜好选择不同的视觉风格。

#### 站点主题（Site Theme）
适用于首页、仪表盘等主要页面：
- **原版主题（Original）**：NovelHub 默认样式，采用蓝色系配色
- **Z-Library 主题**：仿照 Z-Library 的简洁设计风格，采用白色/灰色系配色

#### 阅读主题（Reading Theme）
适用于小说阅读页面：
- **原版（Original）**：与站点主题保持一致
- **日间（Day）**：明亮的白色背景，适合白天阅读
- **夜间（Night）**：深色背景，适合夜晚阅读，保护眼睛
- **护眼（Eye）**：柔和的黄色背景，减少眼睛疲劳
- **Z-Library**：Z-Library 风格的阅读体验

#### 主题设置位置

**管理员设置**：
1. 登录管理员账号
2. 进入"管理员后台" → "系统设置" → "基本设置"
3. 选择"站点主题"和"默认阅读主题"
4. 保存设置

**用户个人设置**（阅读时）：
1. 在阅读页面点击"设置"按钮
2. 在"主题"选项中选择您喜欢的阅读主题
3. 设置会自动保存到浏览器

### 2. Z-Library 书籍导入功能

允许用户导入从 Z-Library 下载的书籍文件。

#### 使用步骤

1. **下载书籍**
   - 从 Z-Library 网站下载 TXT 格式的书籍
   - 确保下载的文件包含完整的内容（目录、正文等）

2. **导入书籍**
   - 登录账号后，进入"作者仪表盘"
   - 点击"导入 Z-Library 书籍"按钮
   - 将书籍内容完整复制并粘贴到文本框中
   - 点击"导入书籍"按钮

3. **导入结果**
   - 系统会自动解析书籍的标题、作者、章节等信息
   - 成功导入后，书籍会显示在您的作品列表中
   - 所有章节会自动创建并发布

#### 支持的格式

系统能够识别以下格式的 Z-Library 书籍：

- 包含"目录"部分的完整文本
- 标准的章节分隔
- 图书元数据（ISBN、出版社、作者等）

#### 导入示例

书籍格式示例：
```
目录

第一章标题
第二章标题
...

图书在版编目（CIP）数据
...
ISBN ...
...

第一章标题

章节正文内容...

第二章标题

章节正文内容...
```

### 3. 数据库与文件双存储模式

系统继续支持灵活的存储模式：

#### 文件存储模式（Files）
- **默认模式**，使用 JSON 文件存储数据
- 无需配置数据库，开箱即用
- 适合小型到中型应用

#### 数据库存储模式（Database）
- 支持 SQLite 和 MySQL
- 更高的性能和扩展性
- 适合大型应用

#### 切换存储模式

1. 进入"管理员后台" → "系统设置" → "存储设置"
2. 选择存储模式（文件或数据库）
3. 如果选择数据库模式，配置数据库连接信息
4. 保存设置

**注意**：切换存储模式需要进行数据迁移，建议在系统初期规划好存储方式。

## 技术实现

### 主题系统实现

- **CSS 文件**：`/assets/style.css`（原版主题）、`/assets/css/theme-zlibrary.css`（Z-Library 主题）
- **JavaScript**：`/assets/reader.js` 支持动态主题切换
- **配置**：主题设置保存在 `/data/system/settings.json`

### 导入功能实现

- **入口页面**：`/import_zlibrary.php`
- **解析逻辑**：
  - 识别目录结构
  - 提取章节内容
  - 解析元数据（ISBN、作者、出版社等）
  - 自动创建小说和章节

### 存储架构

- **JSON 文件**：存储在 `/data` 目录
- **章节文件**：存储在 `/chapters/novel_{id}/` 目录
- **配置文件**：`/config.php` 定义存储路径和模式

## 注意事项

1. **版权问题**：导入的内容应确保您有权发布，尊重原作者的版权
2. **文件大小**：大型书籍可能需要较长的导入时间
3. **格式兼容**：系统尽力解析各种格式，但可能无法识别所有格式的书籍
4. **主题缓存**：更改主题后，如果样式未生效，请尝试清除浏览器缓存

## 未来规划

- 支持更多主题选项（自定义配色）
- 支持导入 EPUB、MOBI 等格式
- 主题编辑器，允许用户自定义主题
- 批量导入功能
- 更智能的内容解析

## 反馈与支持

如果您在使用过程中遇到问题或有改进建议，请通过以下方式反馈：

- GitHub Issues
- 邮件：support@example.com

---

**版本**：v2.0
**更新日期**：2024-01-01
