# NovelHub 阅读界面响应式测试说明

本文件用于指导如何验证全新阅读界面（reading.php）的响应式适配、浏览器兼容性以及性能优化策略。

## 1. 屏幕尺寸适配方案

断点与基础字体大小
- 移动设备 (≤768px)
  - html 基础字号：15px
  - 阅读区高度：calc(100vh - 220px)
  - 显示移动端底部导航栏，图标按钮最小触控尺寸 ≥ 44px
  - 章节标题在顶部隐藏，使用下拉章节选择
- 平板设备 (769px ~ 1024px)
  - html 基础字号：16px
  - 阅读区高度：calc(100vh - 200px)
  - 继续展示顶部/底部控制条，舒适的点击目标尺寸
- 桌面设备 (≥1025px)
  - html 基础字号：17px
  - 内容区最大宽度限制：
    - 窄版：≈38em
    - 标准：≈44em（默认，约 35~45em 推荐范围）
    - 宽版：≈52em

排版规范
- 每行推荐 45~75 个字符，使用 em 限制内容宽度，结合 rem 的字体缩放确保一致性
- 行高默认 1.65，可调整 1.2/1.5/1.8/2.0
- 段落间距默认 0.9em，可在设置面板中调整

安全区域（Safe Area）
- 支持 iOS 刘海屏的 env(safe-area-inset-*)，底部控制条和移动端导航栏均包含 padding-bottom: env(safe-area-inset-bottom)

## 2. 交互与动画测试

通用交互
- 中间区域单击：显示控制条（自动隐藏）
- 中间区域双击：显示/隐藏控制条切换
- 左/右区域单击：上一页/下一页
- 键盘：
  - → / PageDown / 空格：下一页
  - ← / PageUp：上一页
  - Esc：关闭控制条或返回

触摸手势
- 水平滑动（阈值约 42px）：翻页
- 下拉刷新（移动端）：在页面顶部下拉超过约 120px，触发刷新
- 长按：使用系统原生文本选择（支持复制/翻译）

动画
- 控制条淡入淡出（backdrop-filter 毛玻璃 + 透明度）
- 设置/书签面板滑入滑出
- 点击按钮的轻微缩放反馈

## 3. 移动端特定优化

- 底部导航栏（移动端专用）：上一页、书签、设置、专注、下一页
- 双击显示/隐藏控制条，避免误触
- 亮度调节：通过“亮度”滑杆控制阅读层之上的半透明遮罩，实现软亮度调节
- 屏幕常亮：支持 Wake Lock API（浏览器支持时），在设置面板中开启/关闭
- 沉浸式模式：同步 meta theme-color 以适配状态栏

## 4. 浏览器兼容性

核心技术
- CSS 变量、backdrop-filter、env(safe-area-inset-*)、column 布局
- 若浏览器不支持 backdrop-filter，仍可回退为半透明背景
- prefers-reduced-motion：在用户偏好降低动效时禁用动画

已在以下环境下通过基础验证（需进一步按项目要求测试）
- 桌面端：Chrome 最新版、Edge 最新版、Safari 最新版、Firefox（backdrop-filter 视觉稍有差异）
- 移动端：iOS Safari、Android Chrome

## 5. 性能优化建议

- 使用节流/防抖处理 resize 和进度保存：
  - reflow 与 setVH 使用 throttle
  - 保存进度使用防抖（~420ms）
- 使用 passive 监听器优化滚动与触摸事件
- 使用 GPU 友好属性（opacity/transform）进行动画
- 控制条与面板在非显示状态设置 pointer-events: none；减少重绘与点击命中
- 合理使用本地存储缓存阅读设置与游客进度，减少服务端请求
- 静态资源建议配合服务器开启 Cache-Control: public, max-age=31536000 并添加版本号（/assets/reader.css?v=1）

## 6. 回归测试清单

- [ ] 在 360px、768px、1024px、1440px 下手动检查布局
- [ ] 调整字体、行高、段距、宽度模式是否即时生效且保存
- [ ] 主题切换是否同步状态栏颜色（移动端）
- [ ] 移动端底部导航栏按钮触控命中是否足够（≥44px）
- [ ] 水平滑动翻页与点击翻页的响应是否流畅
- [ ] 下拉刷新是否在页面顶部触发且不会误触
- [ ] 书签的增删查功能可用
- [ ] 进度保存（登录态）与本地恢复（未登录）是否正常
- [ ] 专注模式隐藏所有控件，仅保留文字
- [ ] 亮度调节与屏幕常亮开关（若支持）可用

## 7. 代码结构摘要

- /reading.php：响应式阅读页面（PHP + HTML）
- /assets/reader.css：阅读页专用样式（CSS 变量、BEM、断点）
- /assets/reader.js：交互逻辑（手势、设置、进度、动画、Wake Lock）
- /assets/style.css：站点通用样式（保留）

如需进一步扩展：可将图标以 SVG Sprite 独立文件管理、添加章节目录抽屉、分页过渡动画、翻页仿真效果等。
