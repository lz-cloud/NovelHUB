# 书籍信息编辑功能

## 快速开始

### 访问编辑页面

**方式一：作者仪表盘**
```
1. 登录账号
2. 访问 /dashboard.php
3. 找到你的作品，点击"编辑书籍信息"
```

**方式二：书籍详情页**
```
1. 访问任意书籍详情页 /novel_detail.php?novel_id=123
2. 如果你是作者或管理员，会看到"编辑书籍信息"按钮
3. 点击进入编辑页面
```

**方式三：管理后台（管理员）**
```
1. 访问 /admin.php?tab=novels 或 /admin_dashboard.php?tab=content
2. 点击任意书籍旁的"编辑"按钮
```

## 可编辑内容

- ✏️ **书籍标题** - 必填字段
- 🖼️ **封面图片** - 可选上传，支持 JPG/PNG/GIF/WEBP，最大 5MB
- 📂 **分类** - 多选，可选择多个分类
- 🏷️ **标签** - 用逗号分隔，如：玄幻,冒险,热血
- 📝 **简介** - 书籍描述
- 📊 **状态** - 连载中 / 已完结

## 删除书籍

⚠️ **警告：删除操作不可恢复**

1. 进入编辑页面
2. 点击右下角红色"删除小说"按钮
3. 在弹出的确认对话框中再次确认
4. 删除后将清除：
   - 书籍元数据
   - 所有章节内容
   - 用户收藏记录

## 权限说明

- 👤 **作者** - 可以编辑和删除自己的作品
- 👑 **管理员** - 可以编辑和删除任何作品
- 🚫 **其他用户** - 无权访问编辑页面

## 文件位置

- 编辑页面：`/edit_novel.php`
- 辅助函数：`/lib/helpers.php::delete_novel()`

## 相关链接

- 作者仪表盘：`/dashboard.php`
- 书籍详情：`/novel_detail.php`
- 管理后台：`/admin.php`
- 管理仪表盘：`/admin_dashboard.php`

## 技术细节

### 新增函数

```php
// 删除书籍及其所有相关数据
delete_novel(int $novelId): bool
```

### 修改的文件

1. `edit_novel.php` - 新增编辑页面
2. `lib/helpers.php` - 新增 delete_novel() 函数
3. `dashboard.php` - 添加编辑按钮
4. `novel_detail.php` - 添加编辑按钮
5. `admin.php` - 添加编辑按钮，使用新的删除函数
6. `admin_dashboard.php` - 添加编辑按钮，使用新的删除函数

## 常见问题

**Q: 更新封面后旧封面会怎样？**
A: 旧封面文件会自动删除，避免占用存储空间。

**Q: 删除书籍后可以恢复吗？**
A: 不可以，删除是永久性的。建议在删除前做好备份。

**Q: 非作者可以编辑书籍吗？**
A: 不可以，只有作者本人和管理员可以编辑。

**Q: 编辑后更新时间会变化吗？**
A: 是的，`updated_at` 字段会自动更新为当前时间。

**Q: 可以批量编辑书籍吗？**
A: 管理仪表盘支持批量操作（修改分类、删除等）。
